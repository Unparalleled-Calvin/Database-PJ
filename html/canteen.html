<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">

  <link rel="icon" href="{% static '/images/logo.ico' %}" type="image/x-icon">
  <link rel="shortcut icon" href="{% static '/images/logo.ico' %}" type="image/x-icon">
  <!-- General CSS Files -->
  <link rel="stylesheet" href="{% static '/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static '/css/all.css' %}">

  <!-- Template CSS -->
  <link rel="stylesheet" href="{% static '/css/style-purple.css' %}">
  <link rel="stylesheet" href="{% static '/css/components.css' %}">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static '/css/malio.css' %}">

  <title>复旦一卡通</title>

  <!-- C3 chart css -->
  <link rel="stylesheet" href="{% static '/css/c3.min.css' %}">

  <!-- General JS Scripts -->
  <script src="{% static '/js/jquery.min.js' %}"></script>
  <script src="{% static '/js/bootstrap.min.js' %}"></script>
  <!-- Counter Up  -->
  <script src="{% static '/js/jquery.waypoints.min.js' %}"></script>
  <script src="{% static '/js/jquery.counterup.min.js' %}"></script>

  <script src="{% static '/js/sweetalert2.all.min.js' %}"></script>
  <script src="{% static '/js/jquery.js' %}"></script>

  <script>
    $('.counter').counterUp({
      delay: 10,
      time: 1000
    });

    setTimeout(loadTrafficChart(), 3000);
  </script>

  <style>
    .center {
      text-align: center;
    }
  </style>

<body>
  <div id="app">
    <div class="main-wrapper">
      <div class="navbar-bg"></div>
      <nav class="navbar navbar-expand-lg main-navbar">
        <form class="form-inline mr-auto">
          <ul class="navbar-nav mr-3">
            <li><a href="#" id="sidebar-button" class="nav-link nav-link-lg"><i class="fas fa-bars"></i></a>
            </li>
          </ul>
        </form>
        <ul class="navbar-nav navbar-right">
          <li class="dropdown dropdown-list-toggle"></li>
          <li class="dropdown"><a href="#" data-toggle="dropdown"
              class="nav-link dropdown-toggle nav-link-lg nav-link-user">
              <img alt="image" src="{% static '/images/g' %}" class="rounded-circle mr-1">
              <div class="d-sm-none d-lg-inline-block">Hi, Calvin</div>
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <div class="dropdown-divider"></div>
              <a href="logout" class="dropdown-item has-icon text-danger">
                <i class="fas fa-sign-out-alt"></i> 退出登录
              </a>
            </div>
          </li>
        </ul>
      </nav>
      <div class="main-sidebar sidebar-style-2" tabindex="1" style="overflow: hidden; outline: none;">
        <aside id="sidebar-wrapper">
          <div class="sidebar-brand">
            <a href=""> </a>
          </div>
          <div class="sidebar-brand sidebar-brand-sm">
            <a href="">菜单</a>
          </div>
          <ul class="sidebar-menu">
            <li><a class="nav-link" href="/user"><i class="fas fa-school"></i>
                <span>首页</span></a></li>
            <li class="active"><a class="nav-link" href="canteen"><i class=" fas fa-cookie-bite"></i>
                <span>用餐</span></a></li>
            <li><a class="nav-link" href="leave"><i class="fas fa-torii-gate"></i>
                <span>离校</span></a></li>
            <li><a class="nav-link" href="access"><i class="fas fa-building"></i>
                <span>回寝</span></a></li>
          </ul>
        </aside>
      </div>
      <div class="main-content">
        <section class="section">
          <div class="section-header">
            <h1>餐厅</h1>
          </div>
          <div class="row">
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button1"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button2"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button3"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button4"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button5"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card">
                <div class="buttons">
                  <form action="javascript:void(0);" method="POST">
                    {% csrf_token %}
                    <div class="center">
                      <input type="submit" id="order_button6"
                        class="btn btn-icon icon-left btn-primary btn-clash btn-lg btn-round" value="点餐" />
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</body>
</head>


<script>
  function order(buttonid) {
    var csrfToken = $("[name='csrfmiddlewaretoken']").val();

    $.ajax({
      type: "POST",
      url: "canteen",
      dataType: "json",
      data: {
        cuisineid: buttonid,
        csrfmiddlewaretoken: csrfToken,
      },
      success: function (data) {
        if (data.ret == 1) {
          var Msg = '节约光荣，浪费可耻';
          swal('点餐成功', Msg, 'success');
        }
        else {
          var Msg = '请尝试重新点餐';
          swal('错误', Msg, 'error');
        }
      }
    });
  }
  $("#order_button1").click(function () {
    order(1);
  });
  $("#order_button2").click(function () {
    order(2);
  });
  $("#order_button3").click(function () {
    order(3);
  });
  $("#order_button4").click(function () {
    order(4);
  });
  $("#order_button5").click(function () {
    order(5);
  });
  $("#order_button6").click(function () {
    order(6);
  });
</script>

<script>
  $('#sidebar-button').click(function () {
    var body = $('body')
    if (body.hasClass('sidebar-mini')) {
      body.removeClass('sidebar-mini');
      body.addClass('sidebar-show');
    } else {
      body.addClass('sidebar-mini');
      body.removeClass('sidebar-show');
    }
    return false;
  });
  if(window.screen.width < 600){
    var target = document.getElementById("sidebar-button");
    $('body').addClass('sidebar-mini');
    target.style.display="none";
  }
</script>